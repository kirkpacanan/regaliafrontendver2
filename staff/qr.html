<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>QR Check-in | Regalia Staff</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="./staff.css" />
  </head>
  <body>
    <div class="dashboard">
      <div class="sidebar-overlay" data-sidebar-overlay></div>
      <aside class="sidebar">
        <div class="brand">
          <img class="brand-logo" src="../logo.png" alt="Regalia" />
        </div>
        <button class="menu-toggle" type="button" data-sidebar-close>
          <svg viewBox="0 0 24 24">
            <line x1="6" y1="6" x2="18" y2="18"></line>
            <line x1="6" y1="18" x2="18" y2="6"></line>
          </svg>
          Close
        </button>
        <nav class="nav">
          <a href="./index.html">
            <span class="icon">
              <svg viewBox="0 0 24 24">
                <rect x="3" y="3" width="7" height="7" rx="1"></rect>
                <rect x="14" y="3" width="7" height="7" rx="1"></rect>
                <rect x="14" y="14" width="7" height="7" rx="1"></rect>
                <rect x="3" y="14" width="7" height="7" rx="1"></rect>
              </svg>
            </span>
            Dashboard
          </a>
          <a class="active" href="./qr.html">
            <span class="icon">
              <svg viewBox="0 0 24 24">
                <path d="M7 3H3v4M7 21H3v-4M17 3h4v4M17 21h4v-4"></path>
                <path d="M7 7h4v4H7zM13 13h4v4h-4z"></path>
              </svg>
            </span>
            QR Check-in
          </a>
          <a href="./bookings.html">
            <span class="icon">
              <svg viewBox="0 0 24 24">
                <rect x="3" y="4" width="18" height="18" rx="2"></rect>
                <path d="M16 2v4M8 2v4M3 10h18"></path>
              </svg>
            </span>
            Bookings
          </a>
          <a href="./guests.html">
            <span class="icon">
              <svg viewBox="0 0 24 24">
                <path d="M17 21v-2a4 4 0 0 0-4-4H7a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
              </svg>
            </span>
            Guests
          </a>
          <a href="./messages.html">
            <span class="icon">
              <svg viewBox="0 0 24 24">
                <path d="M21 15a4 4 0 0 1-4 4H7l-4 3V7a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4z"></path>
              </svg>
            </span>
            Messages
          </a>
        </nav>
        <div class="sidebar-footer">
          <a href="#" data-open-settings>
            <span class="icon">
              <svg viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="3"></circle>
                <path
                  d="M19.4 15a1.8 1.8 0 0 0 .3 2l-1.4 2.4a1.8 1.8 0 0 1-2.2.8l-1.6-.6a7 7 0 0 1-2.4 1.4l-.2 1.8a1.8 1.8 0 0 1-1.8 1.6H9a1.8 1.8 0 0 1-1.8-1.6l-.2-1.8a7 7 0 0 1-2.4-1.4l-1.6.6a1.8 1.8 0 0 1-2.2-.8L.4 17a1.8 1.8 0 0 0 .3-2l1-1.4a7 7 0 0 1 0-2.8l-1-1.4a1.8 1.8 0 0 0-.3-2L1.8 4a1.8 1.8 0 0 1 2.2-.8l1.6.6a7 7 0 0 1 2.4-1.4l.2-1.8A1.8 1.8 0 0 1 10 0h4a1.8 1.8 0 0 1 1.8 1.6l.2 1.8a7 7 0 0 1 2.4 1.4l1.6-.6a1.8 1.8 0 0 1 2.2.8l1.4 2.4a1.8 1.8 0 0 0-.3 2l-1 1.4a7 7 0 0 1 0 2.8z"
                ></path>
              </svg>
            </span>
            Settings
          </a>
          <a href="../index.html">
            <span class="icon">
              <svg viewBox="0 0 24 24">
                <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path>
                <polyline points="10 17 15 12 10 7"></polyline>
                <line x1="15" y1="12" x2="3" y2="12"></line>
              </svg>
            </span>
            Logout
          </a>
        </div>
      </aside>

      <main class="main">
        <header class="topbar">
          <button class="menu-toggle" type="button" aria-label="Toggle menu">
            <svg viewBox="0 0 24 24">
              <line x1="4" y1="7" x2="20" y2="7"></line>
              <line x1="4" y1="12" x2="20" y2="12"></line>
              <line x1="4" y1="17" x2="20" y2="17"></line>
            </svg>
          </button>
          <div>
            <h1>QR Check-in</h1>
            <p>Scan and validate guest arrivals quickly.</p>
          </div>
          <div class="top-actions">
            <span class="icon">
              <svg viewBox="0 0 24 24">
                <path d="M18 8a6 6 0 0 0-12 0c0 7-3 8-3 8h18s-3-1-3-8"></path>
                <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
              </svg>
            </span>
            <div class="avatar">FD</div>
          </div>
        </header>

        <section class="content-grid qr-grid">
          <div class="panel">
            <h3>Scanner Status</h3>
            <div class="list">
              <div class="list-item">
                <div>
                  Camera: Online
                  <small>Last heartbeat: 2s ago</small>
                </div>
                <span class="icon">
                  <svg viewBox="0 0 24 24">
                    <circle cx="12" cy="12" r="9"></circle>
                  </svg>
                </span>
              </div>
              <div class="list-item">
                <div>
                  Today’s Scans
                  <small>18 successful • 2 failed</small>
                </div>
                <span class="icon">
                  <svg viewBox="0 0 24 24">
                    <polyline points="5 13 9 17 19 7"></polyline>
                  </svg>
                </span>
              </div>
            </div>
          </div>

          <div class="panel panel-stack">
            <h3>Scan a QR</h3>
            <div class="scan-panel">
              <div class="scan-frame">
                <video class="scan-video" playsinline muted></video>
                <div class="scan-corner top-left"></div>
                <div class="scan-corner top-right"></div>
                <div class="scan-corner bottom-left"></div>
                <div class="scan-corner bottom-right"></div>
                <div class="scan-line"></div>
              </div>
              <div>
                <strong>Camera Ready</strong>
                <p class="muted">
                  Align the guest QR code inside the frame to auto-check in.
                </p>
                <div class="scan-status" data-scan-status>
                  Tap start scan to begin.
                </div>
                <div class="scan-actions">
                  <button class="btn ghost" data-start-scan>Start Scan</button>
                  <button class="btn ghost" data-stop-scan>Stop Scan</button>
                  <button class="btn ghost">Upload QR</button>
                </div>
              </div>
            </div>
            <div class="quick-card">
              <div class="quick-icon">
                <svg viewBox="0 0 24 24">
                  <circle cx="11" cy="11" r="7"></circle>
                  <path d="M21 21l-4.3-4.3"></path>
                </svg>
              </div>
              <div>
                <strong>Manual Lookup</strong>
                <p class="muted">Search reservation code or guest name.</p>
              </div>
              <button class="btn ghost">Search Guest</button>
            </div>
            <div class="quick-card">
              <div class="quick-icon">
                <svg viewBox="0 0 24 24">
                  <path d="M22 2 11 13"></path>
                  <path d="M22 2 15 22 11 13 2 9 22 2"></path>
                </svg>
              </div>
              <div>
                <strong>Resend QR</strong>
                <p class="muted">Send QR check-in link by email or SMS.</p>
              </div>
              <button class="btn ghost">Resend</button>
            </div>
          </div>
        </section>

        <section class="panel recent-section">
          <h3>Recent Scans</h3>
          <div class="list">
            <div class="list-item">
              <div>
                Unit 204 • Ocean View Condo
                <small>Scanned 10:14 AM • Pamela Beesly</small>
              </div>
              <span class="icon">
                <svg viewBox="0 0 24 24">
                  <polyline points="5 13 9 17 19 7"></polyline>
                </svg>
              </span>
            </div>
            <div class="list-item">
              <div>
                Unit 310 • Corner Suite
                <small>Scanned 9:52 AM • Dwight Schrute</small>
              </div>
              <span class="icon">
                <svg viewBox="0 0 24 24">
                  <polyline points="5 13 9 17 19 7"></polyline>
                </svg>
              </span>
            </div>
          </div>
        </section>
      </main>
    </div>
    <div class="settings-modal" data-settings-modal>
      <div class="settings-card">
        <div class="settings-header">
          <h2>Settings</h2>
          <button class="settings-close" type="button" data-close-settings>
            Close
          </button>
        </div>
        <div class="settings-fields">
          <label>
            Primary color
            <input type="color" data-setting-teal />
          </label>
          <label>
            Secondary color
            <input type="color" data-setting-green />
          </label>
          <label>
            Font
            <select data-setting-font>
              <option value="Poppins">Poppins</option>
              <option value="system-ui">System</option>
            </select>
          </label>
        </div>
        <div class="settings-presets">
          <button
            type="button"
            data-preset
            data-preset-teal="#1e9db1"
            data-preset-green="#7acb59"
            style="background: linear-gradient(90deg, #1e9db1, #7acb59)"
          >
            Original
          </button>
          <button
            type="button"
            data-preset
            data-preset-teal="#1b6ccf"
            data-preset-green="#21c8a0"
            style="background: linear-gradient(90deg, #1b6ccf, #21c8a0)"
          >
            Ocean
          </button>
          <button
            type="button"
            data-preset
            data-preset-teal="#f05b5b"
            data-preset-green="#f4b04f"
            style="background: linear-gradient(90deg, #f05b5b, #f4b04f)"
          >
            Sunset
          </button>
          <button
            type="button"
            data-preset
            data-preset-teal="#6c5ce7"
            data-preset-green="#00b894"
            style="background: linear-gradient(90deg, #6c5ce7, #00b894)"
          >
            Royal
          </button>
        </div>
        <div class="settings-actions">
          <button class="reset" type="button" data-reset-settings>
            Reset
          </button>
          <button class="save" type="button" data-save-settings>
            Save
          </button>
        </div>
      </div>
    </div>
    <script src="../settings.js"></script>
    <script>
      const startButton = document.querySelector("[data-start-scan]");
      const stopButton = document.querySelector("[data-stop-scan]");
      const scanFrame = document.querySelector(".scan-frame");
      const scanVideo = document.querySelector(".scan-video");
      const scanStatus = document.querySelector("[data-scan-status]");
      let stream = null;

      const startScan = async () => {
        if (!scanVideo || !scanFrame) return;
        scanFrame.classList.add("is-scanning");
        if (scanStatus) {
          scanStatus.textContent = "Starting camera...";
        }
        try {
          stream = await navigator.mediaDevices.getUserMedia({
            video: { facingMode: "environment" },
            audio: false,
          });
          scanVideo.srcObject = stream;
          await scanVideo.play();
          if (scanStatus) {
            scanStatus.textContent = "Scanning... hold QR steady.";
          }
        } catch (error) {
          if (scanStatus) {
            scanStatus.textContent =
              "Camera blocked. Scanning simulation active.";
          }
        }
      };

      const stopScan = () => {
        if (stream) {
          stream.getTracks().forEach((track) => track.stop());
          stream = null;
        }
        if (scanVideo) {
          scanVideo.pause();
          scanVideo.srcObject = null;
        }
        if (scanFrame) {
          scanFrame.classList.remove("is-scanning");
        }
        if (scanStatus) {
          scanStatus.textContent = "Scan stopped.";
        }
      };

      if (startButton) startButton.addEventListener("click", startScan);
      if (stopButton) stopButton.addEventListener("click", stopScan);
      const toggle = document.querySelector(".topbar .menu-toggle");
      const closeButton = document.querySelector("[data-sidebar-close]");
      const overlay = document.querySelector("[data-sidebar-overlay]");
      const navLinks = document.querySelectorAll(".sidebar .nav a");

      const closeSidebar = () => document.body.classList.remove("sidebar-open");
      const toggleSidebar = () =>
        document.body.classList.toggle("sidebar-open");

      if (toggle) toggle.addEventListener("click", toggleSidebar);
      if (closeButton) closeButton.addEventListener("click", closeSidebar);
      if (overlay) overlay.addEventListener("click", closeSidebar);
      navLinks.forEach((link) => link.addEventListener("click", closeSidebar));
    </script>
  </body>
</html>
